[supervisord]
nodaemon=true
user=root
logfile=/var/log/sage/supervisord.log
pidfile=/var/run/supervisord.pid

[program:postgresql]
command=/usr/lib/postgresql/15/bin/postgres -D /var/lib/postgresql/data
user=postgres
autostart=true
autorestart=true
redirect_stderr=true
stdout_logfile=/var/log/sage/postgresql.log
priority=1

[program:sage-mcp]
command=python3 /app/sage_mcp_stdio_v3.py
directory=/app
user=sage
autostart=true
autorestart=true
startsecs=10
redirect_stderr=true
stdout_logfile=/var/log/sage/sage-mcp.log
environment=PYTHONPATH="/app",PYTHONUNBUFFERED="1"
priority=2

[group:sage]
programs=postgresql,sage-mcp
priority=999